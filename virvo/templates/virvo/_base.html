  {% load staticfiles %}<!DOCTYPE html>
<html>
  <head>
    <title>{% block title %}Test layout{% endblock %}</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <link href="{% static 'virvo/grid.css' %}" type="text/css" rel="stylesheet"/>
    
    
    <link rel="stylesheet" type="text/css" href="{% static 'dma/css/bootstrap.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'dma/css/font-awesome.min.css' %}">
    
    <link rel="stylesheet" href="{% static 'gis/assets/css/jquery-ui.css' %}" type = "text/css"/>
    <script src="{%  static 'gis/assets/js/jquery.js' %} "></script>
    <script src="{%  static 'gis/assets/js/jquery-ui.js' %} "></script>
    <script src="{% static 'dma/js/bootstrap.min.js' %}"></script>

    <!-- zTree -->
    <link rel="stylesheet" href="{% static 'zTree/css/demo.css' %}" type="text/css">
    <link rel="stylesheet" href="{% static 'zTree/css/zTreeStyle/zTreeStyle.css' %}" type="text/css">
  
    <script type="text/javascript" src="{% static 'zTree/js/jquery.ztree.core.js' %}"></script>

    <!-- echart -->
    <script src="{% static 'virvo/echarts.min.js' %}"></script>

    {% block stylesheet %}
    <style type="text/css">
    </style>
    {% endblock %}
</head>
<body>
    <div class="wrapper">

      <!-- header -->
      {% include 'virvo/_header.html' %}

      <!-- nav menu -->
      {% include 'virvo/_nav.html' %}

      <div class="box content">
        <!-- breadcrumbs -->
        <div class="breads center">
          <div class="bred_text "><span>{% block breadcrumbs %}首页 / 站点管理{% endblock %}</span></div>
        </div>
          <!-- page title -->
        <div class="page_title center">
          <div class="pg_text"><span>{% block page_title %}站点管理{% endblock %}</span></div>
        </div>
        
        <!-- main contents -->
        <div class="main_content">
          <div class="box treel">
            {% include 'virvo/ogantree.html' %}
          </div>
          
          <div class="box context">
              {% block content %}

              {% endblock %}
          </div>
          
        </div>
        
      </div>
      
    </div>
    {% block javascript %}
    <SCRIPT LANGUAGE="JavaScript">

    $(function(){
        loadTree();
    });


    function loadTree()
    {
       var _this = this;
       // zTree 的参数配置，深入使用请参考 API 文档（setting 配置详解）
       var setting = {
          view: {
            fontCss: getFont,
            nameIsHTML: true
          },

          data: {
            simpleData: {
              enable: true
            }
          }
        };

        function getFont(treeId, node) {
          return node.font ? node.font : {};
        }
            
        $.ajax({
            type:"POST",
            url:"/virvo/gettree/" , 
            dataType: "json",
            data:{'csrfmiddlewaretoken': '{{ csrf_token }}'},
            
            success:function(res){
                var json = res['trees']   
                console.log(json);    
                $.fn.zTree.init($("#treeDemo"), setting, json);
                var zTree = $.fn.zTree.getZTreeObj("treeDemo");
                
            }
        });
    }    
        
</SCRIPT>
    {% endblock %}
</body>
</html>